(function(a){a.fn.catalog=function(b){var c=a.extend({"box":".catalog"},b),d=this.children(":header");return this.each(function(){var h=function(){d.map(function(m,n){var l="catalog"+"-"+n.tagName+"-"+m;n.id=l})};var g=function(){var n=[],m=d.length!=0?d[0].tagName.charAt(1):0,o=0,l=null;n[0]=a("<ol></ol>");n[0].appendTo(a(c.box));d.map(function(p,q){l=a("<li></li>");l.append('<a href="#'+q.id+'">'+q.innerHTML+"</a>");if(m>q.tagName.charAt(1)){o-=parseInt(m)-parseInt(q.tagName.charAt(1))}else{if(m<q.tagName.charAt(1)){o+=parseInt(q.tagName.charAt(1))-parseInt(m);n[o]=a("<ol></ol>");prevLi.append(n[o])}}m=q.tagName.charAt(1);n[o].append(l);prevLi=l})};var j=false;var f=function(){a(c.box+" a").click(function(){j=true;var l=this;a("body").animate({scrollTop:a(a(l).attr("href")).offset().top},"fast",function(){j=false});e(a(l))})};var i=function(){a(window).scroll(function(){d.map(function(l,m){if(a(window).scrollTop()>m.offsetTop){if(!j){e(a(c.box+' a[href="#'+m.id+'"]'))}}})})};var e=function(l){a(c.box+" a").removeClass("active");l.addClass("active");a(c.box+" ol > li > ol").hide();a(c.box+" .active").parents("ol").show();a(c.box+" .active ~ ol").show()};var k=function(){h();g();a(c.box+" ol > li > ol").hide();f();i()};k()})}})(window.jQuery);